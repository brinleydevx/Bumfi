{% extends "base.html" %}
{% block content %}

<h2>{{ user.username }}'s Profile</h2>
{% if user.profile_image %}
    <img src="{{ url_for('static', filename='uploads/' ~ user.profile_image) }}" alt="{{ user.username }} avatar" style="width:96px;height:96px;border-radius:8px;object-fit:cover;">
{% endif %}
{% if user.full_name %}
    <h3>{{ user.full_name }}</h3>
{% endif %}
{% if user.bio %}
    <p class="profile-bio">{{ user.bio }}</p>
{% endif %}
<div class="profile-socials">
    {% if user.website %}
        <a href="{{ user.website }}" target="_blank" rel="noopener">Website</a>
    {% endif %}
    {% if user.github %}
        <a href="{{ user.github }}" target="_blank" rel="noopener">GitHub</a>
    {% endif %}
    {% if user.twitter %}
        <a href="{{ user.twitter }}" target="_blank" rel="noopener">Twitter</a>
    {% endif %}
</div>

{% if user.email %}
<p>Email: {{ user.email }}</p>
{% endif %}

<hr>

<h3>Posts by {{ user.username }}</h3>

{% if posts %}
    {% for post in posts %}
        <article>
            <h4>{{ post.title }}</h4>
            <small>{{ post.date_created.strftime("%Y-%m-%d") }}</small>
            <p>{{ post.content[:150] }}...</p>

            <a href="{{ url_for('main.post_detail', id=post.id) }}">
                Read more
            </a>

            {% if current_user.is_authenticated and current_user == user %}
                |
                <a href="{{ url_for('main.edit_post', id=post.id) }}">
                    Edit
                </a>

                <form method="POST"
                      action="{{ url_for('main.delete_post', post_id=post.id) }}"
                      style="display:inline;">
                    <button type="submit"
                            onclick="return confirm('Delete this post?');">
                        Delete
                    </button>
                </form>
            {% endif %}
        </article>
        <hr>
    {% endfor %}
{% else %}
    <p>No posts yet.</p>
{% endif %}

{% endblock %}
